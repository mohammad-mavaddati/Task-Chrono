<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Chrono</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Ú©Ø¯Ù‡Ø§ÛŒ CSS Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ† Ø§Ù†Ø´Ø¹Ø§Ø¨ÛŒ
           (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù†Ø³Ø®Ù‡ Ù‚Ø¨Ù„ÛŒ)
        */
        
        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ† */
        .timeline-container {
            position: relative;
            padding: 2rem 0;
        }

        /* Ø®Ø· Ø¹Ù…ÙˆØ¯ÛŒ Ù…Ø±Ú©Ø²ÛŒ (ÙÙ‚Ø· Ø¯Ø± Ø¯Ø³Ú©ØªØ§Ù¾) */
        @media (min-width: 640px) {
            .timeline-container::before {
                content: '';
                position: absolute;
                top: 0;
                bottom: 0;
                left: 50%;
                width: 3px;
                background-color: #374151; /* bg-gray-700 */
                transform: translateX(-50%);
                z-index: 0;
            }
        }

        /* Ù‡Ø± Ø¢ÛŒØªÙ… Ø¯Ø± ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ† */
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            width: 100%;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¯Ø³Ú©ØªØ§Ù¾ (Ú†Ù¾ Ùˆ Ø±Ø§Ø³Øª) */
        @media (min-width: 640px) {
            .timeline-item {
                width: 50%;
                padding-left: 2rem;
                padding-right: 2rem;
            }
            
            /* Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø³Ù…Øª Ú†Ù¾ */
            .timeline-item:nth-child(odd) {
                left: 0;
                padding-left: 0;
                padding-right: 2.5rem; /* ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø®Ø· Ù…Ø±Ú©Ø²ÛŒ */
                text-align: right;
            }
            
            /* Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø³Ù…Øª Ø±Ø§Ø³Øª */
            .timeline-item:nth-child(even) {
                left: 50%;
                padding-right: 0;
                padding-left: 2.5rem; /* ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø®Ø· Ù…Ø±Ú©Ø²ÛŒ */
            }

            /* Ù†Ù‚Ø·Ù‡ Ø±ÙˆÛŒ Ø®Ø· Ù…Ø±Ú©Ø²ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¢ÛŒØªÙ… */
            .timeline-item::after {
                content: '';
                position: absolute;
                top: 0.5rem;
                width: 16px;
                height: 16px;
                background-color: #3b82f6; /* bg-blue-500 */
                border: 3px solid #1f2937; /* bg-gray-800 */
                border-radius: 50%;
                z-index: 10;
            }

            /* Ù†Ù‚Ø·Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ú†Ù¾ */
            .timeline-item:nth-child(odd)::after {
                right: -8px; /* Ù†ØµÙ Ø¹Ø±Ø¶ Ù†Ù‚Ø·Ù‡ */
            }
            
            /* Ù†Ù‚Ø·Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø±Ø§Ø³Øª */
            .timeline-item:nth-child(even)::after {
                left: -8px; /* Ù†ØµÙ Ø¹Ø±Ø¶ Ù†Ù‚Ø·Ù‡ */
            }
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù…ÙˆØ¨Ø§ÛŒÙ„ (Ù‡Ù…Ù‡ Ø¯Ø± ÛŒÚ© Ø³Ù…Øª) */
        @media (max-width: 639px) {
            .timeline-item {
                padding-left: 2.5rem; /* ÙØ§ØµÙ„Ù‡ Ø¨Ø±Ø§ÛŒ Ø®Ø· Ùˆ Ù†Ù‚Ø·Ù‡ */
                margin-bottom: 1.5rem;
            }
            
            /* Ø®Ø· Ø¹Ù…ÙˆØ¯ÛŒ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .timeline-container::before {
                content: '';
                position: absolute;
                top: 0;
                bottom: 0;
                right: 8px; /* Ù…ÙˆÙ‚Ø¹ÛŒØª Ø®Ø· */
                width: 3px;
                background-color: #374151; /* bg-gray-700 */
                z-index: 0;
            }

            /* Ù†Ù‚Ø·Ù‡ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .timeline-item::after {
                content: '';
                position: absolute;
                top: 0.5rem;
                right: 0;
                width: 16px;
                height: 16px;
                background-color: #3b82f6; /* bg-blue-500 */
                border: 3px solid #1f2937; /* bg-gray-800 */
                border-radius: 50%;
                z-index: 10;
            }
        }

        /* Ú©Ø§Ø±Øª Ù…Ø­ØªÙˆØ§ÛŒ Ù‡Ø± Ø¢ÛŒØªÙ… */
        .timeline-content {
            background-color: #374151; /* bg-gray-700 */
            border: 1px solid #4b5563; /* bg-gray-600 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .timeline-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ ØªØ§Ø±ÛŒØ® */
        .date-separator {
            text-align: center;
            margin: 2rem 0;
            position: relative;
            z-index: 10;
        }
        .date-separator span {
            background-color: #1f2937; /* bg-gray-800 */
            padding: 0.25rem 1rem;
            border-radius: 99px; /* rounded-full */
            color: #9ca3af; /* text-gray-400 */
            font-weight: bold;
            border: 1px solid #374151; /* bg-gray-700 */
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-6 sm:p-10 font-sans">

    <div class="max-w-4xl mx-auto">

        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-blue-400 mb-4">Task Chrono</h1>
            <div class="bg-gray-800 p-4 rounded-lg shadow-lg border border-gray-700">
                <h2 class="text-sm font-semibold text-gray-400 mb-2">ğŸ”¥ ØªÙ…Ø±Ú©Ø² ÙØ¹Ù„ÛŒ:</h2>
                <div id="current-focus" class="min-h-[50px]">
                    <p class="text-gray-500">Ù‡Ù†ÙˆØ² ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                </div>
            </div>
        </header>

        <main class="bg-gray-800 p-6 rounded-lg shadow-lg mb-10 border border-gray-700">
            <h2 class="text-xl font-bold mb-4">Ø«Ø¨Øª ÙØ¹Ø§Ù„ÛŒØª Ø¬Ø¯ÛŒØ¯</h2>
            
            <div class="mb-4">
                <label for="task-description" class="block mb-2 text-sm font-medium text-gray-300">Ø´Ø±Ø­ ÙØ¹Ø§Ù„ÛŒØª:</label>
                <textarea id="task-description" rows="3" class="w-full p-2.5 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù…Ø´ØºÙˆÙ„..."></textarea>
            </div>
            
            <div class="mb-4">
                <label for="task-category" class="block mb-2 text-sm font-medium text-gray-300">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:</label>
                <select id="task-category" class="w-full p-2.5 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500">
                    <option value="Ú©Ø§Ø±">Ú©Ø§Ø±</option>
                    <option value="ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ">ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ</option>
                    <option value="Ø§Ø³ØªØ±Ø§Ø­Øª">Ø§Ø³ØªØ±Ø§Ø­Øª</option>
                    <option value="Ù…ØªÙØ±Ù‚Ù‡">Ù…ØªÙØ±Ù‚Ù‡</option>
                </select>
            </div>
            
            <button id="log-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 text-lg">
                Ø«Ø¨Øª ÙØ¹Ø§Ù„ÛŒØª
            </button>
        </main>

        <section id="history-section">
            <h2 class="text-2xl font-bold mb-6 text-center">ØªØ§Ø±ÛŒØ®Ú†Ù‡ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§</h2>
            <div id="history-timeline" class="timeline-container">
                </div>
        </section>
    </div>

    <script>
        // Ù…Ø¯ÛŒØ±ÛŒØª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø± localStorage
        const db = {
            get: () => {
                const data = localStorage.getItem('taskChronoLogs');
                return data ? JSON.parse(data) : [];
            },
            save: (logs) => {
                localStorage.setItem('taskChronoLogs', JSON.stringify(logs));
            }
        };

        // Ø¢Ø¨Ø¬Ú©Øª Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
        const app = {
            // state: Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
            state: {
                logs: []
            },

            // elements: Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ø§Ø±Ø¬Ø§Ø¹ Ø¨Ù‡ Ø¹Ù†Ø§ØµØ± DOM
            elements: {
                taskInput: document.getElementById('task-description'),
                categoryInput: document.getElementById('task-category'),
                logButton: document.getElementById('log-button'),
                timeline: document.getElementById('history-timeline'),
                currentFocus: document.getElementById('current-focus')
            },

            // init: ØªØ§Ø¨Ø¹ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ
            init() {
                this.state.logs = db.get(); // Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² localStorage
                this.attachListeners();
                this.render();
                this.updateCurrentFocus(this.state.logs.length > 0 ? this.state.logs[this.state.logs.length - 1] : null);
            },

            // attachListeners: Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
            attachListeners() {
                this.elements.logButton.addEventListener('click', () => this.addLog());
            },

            // addLog: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÛŒÚ© Ù„Ø§Ú¯ Ø¬Ø¯ÛŒØ¯
            addLog() {
                const description = this.elements.taskInput.value;
                const category = this.elements.categoryInput.value;
                
                if (description.trim() === "") {
                    alert("Ù„Ø·ÙØ§Ù‹ Ø´Ø±Ø­ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ÛŒØª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
                    return;
                }

                const now = new Date();
                const logEntry = {
                    id: now.getTime(),
                    time: now.toLocaleTimeString('fa-IR', { hour: '2-digit', minute: '2-digit' }),
                    date: now.toLocaleDateString('fa-IR'), // Ø°Ø®ÛŒØ±Ù‡ ØªØ§Ø±ÛŒØ®
                    description: description,
                    category: category
                };

                this.state.logs.push(logEntry);
                db.save(this.state.logs); // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage

                this.elements.taskInput.value = ""; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙˆØ±ÙˆØ¯ÛŒ
                this.render(); // Ø±Ù†Ø¯Ø± Ù…Ø¬Ø¯Ø¯ ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ†
                this.updateCurrentFocus(logEntry); // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÙ…Ø±Ú©Ø² ÙØ¹Ù„ÛŒ
            },
            
            // updateCurrentFocus: Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø®Ø´ ØªÙ…Ø±Ú©Ø² ÙØ¹Ù„ÛŒ
            updateCurrentFocus(logEntry) {
                if (!logEntry) {
                    this.elements.currentFocus.innerHTML = '<p class="text-gray-500">Ù‡Ù†ÙˆØ² ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
                    return;
                }
                
                this.elements.currentFocus.innerHTML = `
                    <p classG="text-lg text-white">${logEntry.description}</p>
                    <div class="flex justify-between items-center mt-1">
                        <span class="text-sm text-blue-400">[${logEntry.time}]</span>
                        <span class="text-xs bg-gray-700 px-2 py-0.5 rounded-full">${logEntry.category}</span>
                    </div>
                `;
            },

            // render: Ø±Ù†Ø¯Ø± Ú©Ø±Ø¯Ù† Ú©Ù„ ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ†
            render() {
                this.elements.timeline.innerHTML = ""; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ§ÛŒÙ…â€ŒÙ„Ø§ÛŒÙ†
                
                if (this.state.logs.length === 0) {
                     this.elements.timeline.innerHTML = '<p class="text-center text-gray-500">ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>';
                     return;
                }
                
                let lastDate = null; // Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙˆÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±ÙˆØ²

                // Ù…Ø§ Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø±Ø¹Ú©Ø³ Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… ØªØ§ Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†â€ŒÙ‡Ø§ Ø¨Ø§Ù„Ø§ Ø¨Ø§Ø´Ù†Ø¯
                [...this.state.logs].reverse().forEach(entry => {
                    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ ØªØ§Ø±ÛŒØ®
                    if (entry.date !== lastDate) {
                        this.elements.timeline.appendChild(this.createDateSeparatorElement(entry.date));
                        lastDate = entry.date;
                    }
                    
                    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ… Ù„Ø§Ú¯
                    this.elements.timeline.appendChild(this.createLogElement(entry));
                });
            },

            // createLogElement: Ø³Ø§Ø®ØªÙ† HTML Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ø¢ÛŒØªÙ… Ù„Ø§Ú¯ (Ú©Ø§Ø±Øª)
            createLogElement(entry) {
                const li = document.createElement('div');
                li.className = 'timeline-item';
                
                li.innerHTML = `
                    <div class="timeline-content">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold text-blue-400 text-lg">${entry.time}</span>
                            <span class="text-sm font-semibold bg-gray-800 px-2 py-0.5 rounded">
                                ${entry.category}
                            </span>
                        </div>
                        <p class="text-gray-200">${entry.description}</p>
                    </div>
                `;
                return li;
            },

            // createDateSeparatorElement: Ø³Ø§Ø®ØªÙ† HTML Ø¨Ø±Ø§ÛŒ Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ ØªØ§Ø±ÛŒØ®
            createDateSeparatorElement(date) {
                const div = document.createElement('div');
                div.className = 'date-separator';
                div.innerHTML = `<span>${date}</span>`;
                return div;
            }
        };

        // Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡
        app.init();
    </script>
</body>
</html>
