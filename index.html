<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Chrono</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .timeline-container {
            position: relative;
            padding: 2rem 0;
        }

        @media (min-width: 640px) {
            .timeline-container::before {
                content: '';
                position: absolute;
                top: 0;
                bottom: 0;
                left: 50%;
                width: 3px;
                background-color: #374151;
                transform: translateX(-50%);
                z-index: 0;
            }
        }

        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            width: 100%;
        }

        @media (min-width: 640px) {
            .timeline-item {
                width: 50%;
                padding-left: 2rem;
                padding-right: 2rem;
            }
            
            .timeline-item:nth-child(odd) {
                left: 0;
                padding-left: 0;
                padding-right: 2.5rem;
                text-align: right;
            }
            
            .timeline-item:nth-child(even) {
                left: 50%;
                padding-right: 0;
                padding-left: 2.5rem;
            }

            .timeline-item::after {
                content: '';
                position: absolute;
                top: 0.5rem;
                width: 16px;
                height: 16px;
                background-color: #3b82f6;
                border: 3px solid #1f2937;
                border-radius: 50%;
                z-index: 10;
            }

            .timeline-item:nth-child(odd)::after {
                right: -8px;
            }
            
            .timeline-item:nth-child(even)::after {
                left: -8px;
            }
        }
        
        @media (max-width: 639px) {
            .timeline-item {
                padding-left: 2.5rem;
                margin-bottom: 1.5rem;
            }
            
            .timeline-container::before {
                content: '';
                position: absolute;
                top: 0;
                bottom: 0;
                right: 8px;
                width: 3px;
                background-color: #374151;
                z-index: 0;
            }

            .timeline-item::after {
                content: '';
                position: absolute;
                top: 0.5rem;
                right: 0;
                width: 16px;
                height: 16px;
                background-color: #3b82f6;
                border: 3px solid #1f2937;
                border-radius: 50%;
                z-index: 10;
            }
        }

        .timeline-content {
            background-color: #374151;
            border: 1px solid #4b5563;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .timeline-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .date-separator {
            text-align: center;
            margin: 2rem 0;
            position: relative;
            z-index: 10;
        }
        .date-separator span {
            background-color: #1f2937;
            padding: 0.25rem 1rem;
            border-radius: 99px;
            color: #9ca3af;
            font-weight: bold;
            border: 1px solid #374151;
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-6 sm:p-10 font-sans">

    <div class="max-w-4xl mx-auto">

        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-blue-400 mb-4">Task Chrono</h1>
            <div class="bg-gray-800 p-4 rounded-lg shadow-lg border border-gray-700">
                <h2 class="text-sm font-semibold text-gray-400 mb-2">ğŸ”¥ ØªÙ…Ø±Ú©Ø² ÙØ¹Ù„ÛŒ:</h2>
                <div id="current-focus" class="min-h-[50px]">
                    <p class="text-gray-500">Ù‡Ù†ÙˆØ² ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
                </div>
            </div>
        </header>

        <main class="bg-gray-800 p-6 rounded-lg shadow-lg mb-10 border border-gray-700">
            <h2 class="text-xl font-bold mb-4">Ø«Ø¨Øª ÙØ¹Ø§Ù„ÛŒØª Ø¬Ø¯ÛŒØ¯</h2>
            
            <div class="mb-4">
                <label for="task-description" class="block mb-2 text-sm font-medium text-gray-300">Ø´Ø±Ø­ ÙØ¹Ø§Ù„ÛŒØª:</label>
                <textarea id="task-description" rows="3" class="w-full p-2.5 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù…Ø´ØºÙˆÙ„..."></textarea>
            </div>
            
            <div class="mb-4">
                <label for="task-category" class="block mb-2 text-sm font-medium text-gray-300">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ:</label>
                <select id="task-category" class="w-full p-2.5 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-blue-500 focus:border-blue-500">
                    <option value="Ú©Ø§Ø±">Ú©Ø§Ø±</option>
                    <option value="ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ">ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ</option>
                    <option value="Ø§Ø³ØªØ±Ø§Ø­Øª">Ø§Ø³ØªØ±Ø§Ø­Øª</option>
                    <option value="Ù…ØªÙØ±Ù‚Ù‡">Ù…ØªÙØ±Ù‚Ù‡</option>
                </select>
            </div>
            
            <button id="log-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 text-lg">
                Ø«Ø¨Øª ÙØ¹Ø§Ù„ÛŒØª
            </button>
        </main>

        <section id="history-section">
            <h2 class="text-2xl font-bold mb-6 text-center">ØªØ§Ø±ÛŒØ®Ú†Ù‡ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§</h2>
            <div id="history-timeline" class="timeline-container">
            </div>
        </section>
    </div>

    <script>
        const db = {
            get: () => {
                const data = localStorage.getItem('taskChronoLogs');
                return data ? JSON.parse(data) : [];
            },
            save: (logs) => {
                localStorage.setItem('taskChronoLogs', JSON.stringify(logs));
            }
        };

        const app = {
            state: {
                logs: []
            },

            elements: {
                taskInput: document.getElementById('task-description'),
                categoryInput: document.getElementById('task-category'),
                logButton: document.getElementById('log-button'),
                timeline: document.getElementById('history-timeline'),
                currentFocus: document.getElementById('current-focus')
            },

            init() {
                this.state.logs = db.get();
                this.attachListeners();
                this.render();
                this.updateCurrentFocus(this.state.logs.length > 0 ? this.state.logs[this.state.logs.length - 1] : null);
            },

            attachListeners() {
                this.elements.logButton.addEventListener('click', () => this.addLog());
            },

            addLog() {
                const description = this.elements.taskInput.value;
                const category = this.elements.categoryInput.value;
                
                if (description.trim() === "") {
                    alert("Ù„Ø·ÙØ§Ù‹ Ø´Ø±Ø­ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ÛŒØª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
                    return;
                }

                const now = new Date();
                const logEntry = {
                    id: now.getTime(),
                    time: now.toLocaleTimeString('fa-IR', { hour: '2-digit', minute: '2-digit' }),
                    date: now.toLocaleDateString('fa-IR'),
                    description: description,
                    category: category
                };

                this.state.logs.push(logEntry);
                db.save(this.state.logs);

                this.elements.taskInput.value = "";
                this.render();
                this.updateCurrentFocus(logEntry);
            },
            
            updateCurrentFocus(logEntry) {
                if (!logEntry) {
                    this.elements.currentFocus.innerHTML = '<p class="text-gray-500">Ù‡Ù†ÙˆØ² ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
                    return;
                }
                
                this.elements.currentFocus.innerHTML = `
                    <p class="text-lg text-white">${logEntry.description}</p>
                    <div class="flex justify-between items-center mt-1">
                        <span class="text-sm text-blue-400">[${logEntry.time}]</span>
                        <span class="text-xs bg-gray-700 px-2 py-0.5 rounded-full">${logEntry.category}</span>
                    </div>
                `;
            },

            render() {
                this.elements.timeline.innerHTML = "";
                
                if (this.state.logs.length === 0) {
                     this.elements.timeline.innerHTML = '<p class="text-center text-gray-500">ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>';
                     return;
                }
                
                let lastDate = null;

                [...this.state.logs].reverse().forEach(entry => {
                    if (entry.date !== lastDate) {
                        this.elements.timeline.appendChild(this.createDateSeparatorElement(entry.date));
                        lastDate = entry.date;
                    }
                    
                    this.elements.timeline.appendChild(this.createLogElement(entry));
                });
            },

            createLogElement(entry) {
                const li = document.createElement('div');
                li.className = 'timeline-item';
                
                li.innerHTML = `
                    <div class="timeline-content">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold text-blue-400 text-lg">${entry.time}</span>
                            <span class="text-sm font-semibold bg-gray-800 px-2 py-0.5 rounded">
                                ${entry.category}
                            </span>
                        </div>
                        <p class="text-gray-200">${entry.description}</p>
                    </div>
                `;
                return li;
            },

            createDateSeparatorElement(date) {
                const div = document.createElement('div');
                div.className = 'date-separator';
                div.innerHTML = `<span>${date}</span>`;
                return div;
            }
        };

        app.init();
    </script>
</body>
</html>
